# Environment Model

A binding is an assoc. of a name to value.
Name must be unique.

Environment consists of a set of bindings...
An environment is a sequence of frames
A frame is a table of bindings.

| Name | Value |
|------|-------|
   x      1
   y      2

Each frame has a pointer to its enclosing environment. UNLESS
the frame is the primitive frame...

The environment is used as a lookup table. In most programs the environment actually consists of a set of nested environments. Given the name of something in a program (usually a variable of procedure) the associated value can be found by searching the set of bindings for the current program according to the scoping rules for the language.

The root, or outermost, environment is called the primitive environment.
There are two common forms of maintaining bindings: dynamic and lexical scoping
Dynamic Scoping is the method used to define the scope and extent of variables in Lisp and APL. The environments are searched in the reverse order of invocation. It is as if the return "address" is used to find the environments of the callers.
Lexical Scoping (sometimes called static) is the method used to define the scope and extent of variables in Scheme, Common Lisp, Pascal and Algol. Lexical scoping requires keeping track of the lexical order as well as the dynamic execution order at runtime. This means that a Scheme procedure call will, of necessity, be more expensive than a similar call in C or Fortran
Deep Binding: Most common implementation. Each environment consists of a collection of variables names and values. The environments are linked according to the scoping rules. When a name is used in a procedure the environments are searched from the inner to the outer nesting level.
Shallow Binding: Associate bindings for each variable and then search the bindings associated with the variable to find the binding for the current environment. The major advantage is that it reduces the search time for variables that are bound in the global environment.

### Contour Model

A graphical model of runtime environments for block structured programming languages.

References: Data Structures in Programming Languages - ACM Sigplan Notices, 1973
The Contour Model of Block Structured Processes, J.B. Johnston, pp 55-82.

### Visualizing the Contour Model

```
line 1:    (define b 5)
line 2:    (define (square num)
line 3:        (* num num))
line 4:    (define result (square 5))
```

The steps for evaluation:
- Evaluate each of the subexpressions (within a given environment)
- Create a new frame in which the formal parameter names of the function are bound with the results of evaluating the operands
- Add this frame to the a new environment created within the ep of the procedure
- Evaluate the body of the function with respect to the new frame and return the result

Notes on this part:
- Primitive Environment is created by Scheme
- User-Environment is one generated by read-eval-print loop (also known as the Global-Environment)
- Bind variables b and square to associated values in a frame in the User-environment
